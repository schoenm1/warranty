\newpage

\subsection{Ansteuerung der Kamera} \index{Kamera|(}
Die Kamera stellt in Warranty eines der zentralen Teile dar, da die Hauptfunktion der App auf dem Speichern von Fotos basiert. Dementsprechend ist es wichtig, dass der Code, der diese Funktionalität bereitstellt übersichtlich und nicht aufgebläht ist und stabil läuft.

\subsubsection{Externen Storage einbinden}
Damit die aufgenommen Bilder in zukünfitgen Releasen einfach exportiert werden können, werden diese in einem eigenen Directory auf dem externen Storage gespeichert. Dies hat zusätzlich den Vorteil, dass der User beim anschliessen des Smartphones an den Computer dieses als externes Storage- Device mounten und somit einfach auf die aufgenommen Bilder zugreifen kann.

Zu Beginn wird der Zielspeicherort für die Bilder definiert und anschliessend geprüft ob
\begin{enumerate}
\item die SDCard gemountet ist
\item das Speicherverzeichnis existiert
\item das Speicherverzeichnis, falls inexistent, erstellt werden kann
\end{enumerate}
Mit dieser Prozedur kann sichergestellt werden, dass die Kamera- Applikation Bilder schreiben kann.

\lstset{language=Java, numbers=left}
\begin{lstlisting}[label=lst:tbl_attr_names, captionpos=b, caption={Zugriff auf SDCard, PhotoActivity.java}]
private File getPhotoDir() {
	File storageDir = new File(Environment.getExternalStorageDirectory() + "/Warranty");
	if (Environment.MEDIA_MOUNTED.equals(Environment.getExternalStorageState())) {
		if (storageDir != null) {
			if (!storageDir.mkdirs()) {
				if (!storageDir.exists()) {
					Log.d("getPhotoDir()", "failed to create directory");
					return null;
				}
				...
			...
		return storageDir;
\end{lstlisting}

\subsubsection{Bilddatei erstellen}
Da der von Android bereitgestellten Kamera- Applikation anschliessend ein leeres File übergeben werden muss, ist der nächste Schritt, ein leeres File zu erstellen. \\
Um die Eindeutigkeit des Files sicherzustellen, bedient sich Warranty den beiden Java- eigenen Klassen \textit{Date} und  \textit{SimpleDateFormat}. Mit Hilfe der Klasse \textit{SimpleDateFormat} wird der Dateinamen wie folgt aufgebaut: \textbf{yyyyMMdd\_HHmmss}. Die von Warranty verwendeten Buchstaben haben gemäss Javadoc der Klasse  SimpleDateFormat\footnote{\url{http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html}} folgende Bedeutung:\\

\begin{tabbing}
\hspace{50px}\=\kill
y \>Year \\
M \>Month \\
d \>Day \\
H \>Hour \\
m \>Minute \\
s \>Second \\
\end{tabbing}
\textbf{Beispiel:}\\
Der 12. Oktober 2012 zur Zeit 15:27:42 Uhr wird als 20121012\_152742 dargestellt.

\index{Kamera|)}
